---
title: "DTP vaccinations Report"
author: |
  G.J.R. Weydemuller (student number)  
  L. Waaijenberg (2862154)  
  P. Gandra Rodrigues (2870539)  
  Q. Faber (2861921)  
  R.A. Kali (2850680)  
  T. Adam (student number)  
  T.M.V. Verbeek (student number)
date: "`r Sys.Date()`"
output: html_document
---


```{r package_install, include=FALSE}
options(repos = c(CRAN = "https://cloud.r-project.org"))
install.packages("tidyverse")
install.packages("readxl")
install.packages("dplyr")
install.packages("sf")
install.packages("rnaturalearth")
install.packages("rnaturalearthdata")
install.packages("ggplot2")
install.packages("viridis")
install.packages("grid")
install.packages("countrycode")
```

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
library(dplyr)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(ggplot2)
library(viridis)
library(grid)
```



---

**Tutor:** J.F. Fitzgerald  
**Tutorial Group:** Tutorial group 1  
**Course:** Programming for Economists  
**Institute:** Vrije Universiteit Amsterdam

---

# Problem Motivation and Literature

## Why is DTP Vaccination a Social Problem?

DTP vaccination, protecting against diphtheria, tetanus, and pertussis, is a cornerstone of global public health. It is one of the most cost-effective interventions, preventing an estimated 4.4 million deaths annually (UNICEF, 2024). Despite its proven effectiveness and inclusion in nearly all national immunization schedules, millions of children worldwide remain under-vaccinated or entirely unvaccinated. In 2023 alone, approximately 21 million children were either unvaccinated or under-vaccinated, with 14.5 million receiving no vaccines at all (UNICEF, 2024). This gap in coverage leads to preventable illness, long-term disability, and death, particularly in low- and middle-income countries (Our World in Data, sd). The issue is not merely medical but deeply social, as it reflects and reinforces inequalities in access to healthcare, education, and infrastructure (UNICEF, 2024).

Vaccination coverage is also a proxy for the strength of a country’s healthcare system. Low DTP coverage often signals broader systemic issues such as poverty, conflict, misinformation, and weak governance. These factors disproportionately affect vulnerable populations, making DTP vaccination a critical indicator of social justice and equity (UNICEF, 2024).

## Research Question

**"How does government healthcare spending per capita correlate with national vaccination coverage rates for routine immunizations in low-, middle-, and high-income countries?"**

## Sources Identifying DTP Vaccination as a Social Problem

- The **World Health Organization (WHO)** and **UNICEF** have jointly warned that vaccine-preventable diseases, including diphtheria, are resurging due to declining immunization coverage, misinformation, and funding cuts. They emphasize that millions of children are at risk, and urgent investment in immunization is needed to prevent a reversal of decades of progress (WHO Media Team, 2025).

- **UNICEF** outlines the severe consequences of DTP-preventable diseases. Diphtheria can cause heart and nerve damage, tetanus is often fatal even with treatment, and pertussis can lead to pneumonia and death in infants. These diseases disproportionately affect children in low-resource settings, highlighting the social dimension of under-vaccination (UNICEF, sd).

- A **UNICEF data report** on DTP vaccine dropout rates shows that millions of children start but do not complete the DTP series. This dropout is especially prevalent in low-income countries and is linked to systemic barriers such as healthcare access, education, and infrastructure (Wang et al., 2019).

## What Has Not Been Fully Researched

While many studies have examined DTP coverage and its determinants, there is limited comparative analysis across income groups that links government healthcare spending per capita directly to national DTP vaccination rates. Most existing research focuses on either micro-level determinants (e.g., parental education, rural access) or macro-level trends without integrating economic policy variables. UNICEF notes that while DTP3 coverage is widely used as a marker of how well countries provide routine immunization, disparities persist, and economic factors such as national healthcare investment are often underexplored in comparative frameworks (UNICEF, 2024).

## Contribution of This Report

This report aims to fill that gap by analyzing how government healthcare spending correlates with DTP vaccination coverage across low-, middle-, and high-income countries. This research will provide new insights into whether increased public investment in health translates into better immunization outcomes. This could inform both global health policy and economic development strategies, especially in resource-constrained settings.

---

# Data Sourcing

## Load in Data

```{r Load in data}

url_spending <- "https://www.dropbox.com/scl/fi/01df0ly3ornjgcis9kwsk/CHE-per-region.csv?rlkey=nwvmxv33dc3uvp9pnil4tqimk&st=5zgoazd8&dl=1"

url_coverage <- "https://www.dropbox.com/scl/fi/08rf7e6sj3hcq3e5fnp8l/datasetcoverage.xlsx?rlkey=x9iwcifdi2vmqa3j4oy1zs7p3&st=g5kdhaib&dl=1"

url_childdeath <- "https://www.dropbox.com/scl/fi/wuopfxxyux4dccc9rbibn/child-death.csv?rlkey=mfqw1b76522vtjqxcz7grvtmb&st=v0q288at&dl=1"
```

### Data Source Credibility

Source 1: DTP Vaccination Coverage

- Credibility: This dataset is published by the World Health Organization (WHO), the leading global authority on public health. WHO collaborates with national governments and UNICEF to compile and validate immunization data (World Health Organization, 2024).
- Data Quality: The dataset includes WHO/UNICEF Estimates of National Immunization Coverage (WUENIC), which are based on a combination of administrative data, household surveys, and expert review. This triangulation improves accuracy and reliability.
- Relevance: It directly provides the DTP3 coverage rates, which are central to the research question. The data is also disaggregated by region and year, allowing for temporal and cross-regional analysis.

Source 2: Government Healthcare Spending

- Credibility: The World Bank is a globally respected institution that provides standardized economic and development data. It sources health expenditure data from the WHO Global Health Expenditure Database (World Bank, 2024).
- Data Quality: The data is collected using internationally accepted methodologies and is updated annually. It includes consistent country-level indicators, making it ideal for cross-country comparisons.
- Relevance: This dataset provides the independent variable in the analysis—government health spending per capita—which is used to explore its correlation with vaccination coverage.

Source 3: Child Death Rates

- Credibility: This data is also from the World Health Organization, specifically its Global Health Observatory (GHO), which is the main repository for WHO’s health-related statistics (World Health Organization, 2024).
- Data Quality: The under-five mortality data is compiled from national vital registration systems, surveys, and statistical modeling, and is reviewed by global health experts.
- Relevance: While not part of the main correlation analysis, this dataset provides valuable contextual insight into the broader social impact of vaccination coverage and healthcare investment.

## Provide a short summary of the datasets
```{r Convert data, include=FALSE}
# Download het bestand tijdelijk en lees het in
temp_file <- tempfile(fileext = ".xlsx")
download.file(url_coverage, destfile = temp_file, mode = "wb")
df <- read_excel(temp_file)

# Read the CSV into a dataframe
raw_healthspending_data <- read.csv(url_spending)
raw_healthspending_data <- raw_healthspending_data %>%
select(Indicator, Location, Period, Value)


# Read the CSV into a dataframe
raw_childdeath_data <- read.csv(url_childdeath)
```

```{r summary data, echo=FALSE}
head(raw_healthspending_data)
head(df)
```

## Metadata

### WHO DTP Vaccination Coverage

- **Antigen:** DTP1 and DTP3  
- **Coverage:** Vaccinated target population  
  - **Units:** Percentage  
- **Target Population:** Target population for the given vaccine  
- **Years Covered:** 1980–2023  
- **Region:** WHO regions  
- **Frequency:** Annual  
- **Source:** WHO/UNICEF Joint Reporting Form and surveys (e.g., DHS, MICS)  
- **Estimation Method:** Combination of administrative data, surveys, and expert review  

### World Bank Health Spending

- **Indicator:** Current health expenditure per capita  
- **Years Covered:** 2000–2023  
- **Region:** WHO regions  
- **Frequency:** Annual  
- **Units:** US dollars  
- **Source:** WHO Global Health Expenditure Database  

## Suitability for the Research Topic

The research question investigates the relationship between government healthcare spending and DTP vaccination coverage across income groups. These datasets are ideal because:

- They are comprehensive and global, enabling cross-country comparisons.  
- They are updated annually, supporting time-series or cross-sectional analysis.  
- They are standardized and well-documented, ensuring data quality and reproducibility.  

## Data Limitations

Despite their strengths, both datasets have limitations:

### WHO DTP Coverage

- Some countries have missing or estimated values, especially in conflict zones.  
- Coverage estimates may be influenced by reporting biases or survey recall errors.  
- The data may not fully reflect subnational disparities in vaccination access.  

### World Bank Health Spending

- Spending data are in current US dollars, which may be affected by inflation and exchange rate fluctuations.  
- The data do not indicate how funds are allocated (e.g., toward immunization vs. other services).  
- Some countries have incomplete or outdated records for recent years.  

These limitations mean that while the analysis can reveal correlations, it cannot establish causality or account for all contextual factors.

---

# Quantifying

## Data Cleaning

To prepare the datasets for analysis, we performed several cleaning steps to ensure consistency, accuracy, and compatibility across sources.

### Health Spending Data

We began by selecting the relevant columns from the raw health spending dataset and renaming them for clarity. We also ensured that the `Year` and `Spending` columns were numeric to support time-based analysis:

```{r}
cleaned_healthspending_data <- raw_healthspending_data %>%
  select(Region = Location, Year = Period, Spending = Value) %>%
  mutate(
    Year = as.numeric(Year),
    Spending = as.numeric(Spending)
  )
```

This step was essential to align the data with the DTP vaccination dataset, which also uses `Region` and `Year` as key identifiers.

### DTP Vaccination Coverage Data

Next, we filtered the immunization dataset to include only WHO regions and WUENIC estimates, which are considered the most reliable. We also created a new variable, `PeriodGroup`, to group years into meaningful intervals for trend analysis:

```{r}
cleaned_dtpdata <- df %>%
  filter(
    COVERAGE_CATEGORY == "WUENIC",
    GROUP == "WHO_REGIONS"
  ) %>%
  select(Region = NAME, Year = YEAR, Coverage = COVERAGE) %>%
  mutate(
    Year = as.numeric(Year),
    Coverage = as.numeric(Coverage),
    PeriodGroup = case_when(
      Year >= 2000 & Year <= 2004 ~ "2000–2004",
      Year >= 2005 & Year <= 2009 ~ "2005–2009",
      Year >= 2010 & Year <= 2014 ~ "2010–2014",
      Year >= 2015 & Year <= 2019 ~ "2015–2019",
      Year >= 2020 & Year <= 2022 ~ "2020–2022"
    )
  )
```

This transformation allows us to analyze changes in vaccination coverage over time in a more interpretable way.

### Child Mortality Data

We also prepared the child mortality dataset by selecting and renaming relevant columns, and converting values to numeric types:

```{r}
childdeath_selected <- raw_childdeath_data %>%
  select(Region = Location, Year = Period, Deaths = FactValueNumeric)

childdeath_typed <- childdeath_selected %>%
  mutate(
    Year = as.numeric(Year),
    Deaths = as.numeric(Deaths)
  )
```

This ensures that the dataset can be merged with the others on `Region` and `Year`.


### Error Handling and Fixes

During the cleaning process, we encountered several common issues:

- **Missing values (`NA`)**: These were removed using `na.omit()` or filtered out using `filter(!is.na(...))` to ensure clean merges.
- **Non-numeric values**: Some columns were read as character types and had to be converted using `as.numeric()`.
- **Inconsistent region names**: We verified that region names matched across datasets. In an ideal scenario, standardized region codes (e.g., ISO or WHO codes) would be used to avoid ambiguity.
- **Data alignment**: We ensured that all datasets used the same time format and level of aggregation (annual, by WHO region).

## Necessary Variable

To analyze trends over time, we created a **period variable** for each dataset to group years into meaningful intervals. This allows us to compare average values across consistent time blocks.

### Health Spending

We created a new variable `Period` in the health spending dataset using `mutate()` and `case_when()`:

```{r}
healthspending_with_period <- cleaned_healthspending_data %>%
  mutate(Period = case_when(
    Year >= 2000 & Year <= 2004 ~ "2000–2004",
    Year >= 2005 & Year <= 2009 ~ "2005–2009",
    Year >= 2010 & Year <= 2014 ~ "2010–2014",
    Year >= 2015 & Year <= 2019 ~ "2015–2019",
    Year >= 2020 & Year <= 2022 ~ "2020–2022",
    TRUE ~ NA_character_
  ))
```

We then calculated the **average health spending** per region and period:

```{r}
avg_healthspending_by_period <- healthspending_with_period %>% 
  filter(!is.na(Period)) %>%
  group_by(Region, Period) %>%
  summarise(
    AvgSpending = mean(Spending, na.rm = TRUE),
    .groups = "drop"
  )
```


- **Variables used**: `Spending`, `Region`, `Period`  
- **Purpose**: Calculates average health spending per region and period.  
- **Usefulness**: Highlights regional differences and trends in health investment.  
- **Intended analysis**: Visualize and compare health spending across time and regions.

### DTP Vaccination Coverage

For the DTP dataset, we used an existing variable `PeriodGroup` (created earlier) and calculated the **average vaccination coverage** per region and period:

```{r}
DTPcoverage <- cleaned_dtpdata %>%
  filter(!is.na(PeriodGroup)) %>%
  group_by(Region, PeriodGroup) %>%
  summarise(
    AvgCoverage = mean(Coverage, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  arrange(Region)
```

- **Variables used**: `Coverage`, `Region`, `PeriodGroup`  
- **Purpose**: Computes average DTP vaccine coverage per region and period.  
- **Usefulness**: Evaluates immunization program effectiveness.  
- **Intended analysis**: Track vaccine coverage trends and relate to health outcomes

### Child Mortality

We also created a `Period` variable for the child mortality dataset:

```{r}
childdeath_with_period <- childdeath_typed %>%
  mutate(Period = case_when(
    Year >= 2000 & Year <= 2004 ~ "2000–2004",
    Year >= 2005 & Year <= 2009 ~ "2005–2009",
    Year >= 2010 & Year <= 2014 ~ "2010–2014",
    Year >= 2015 & Year <= 2019 ~ "2015–2019",
    Year >= 2020 & Year <= 2022 ~ "2020–2022",
    TRUE ~ NA_character_
  ))
```

We then summarized the **average number of child deaths** per region and period:

```{r}
avg_childdeath_by_period <- childdeath_with_period %>%
  filter(!is.na(Period)) %>%
  group_by(Region, Period) %>%
  summarise(
    AvgChildDeath = mean(Deaths, na.rm = TRUE),
    .groups = "drop"
  )
```

- **Variables used**: `Deaths`, `Region`, `Period`  
- **Purpose**: Calculates average child deaths per region and period.  
- **Usefulness**: Measures health outcomes and can be linked to spending and coverage.  
- **Intended analysis**: Identify regions with high or declining child mortality and explore correlations.


These variables allow us to compare trends in health spending, vaccination coverage, and child mortality across WHO regions and over time.

## Merging Datasets

To analyze the relationship between healthcare spending, DTP vaccination coverage, and child mortality, it was necessary to combine all three datasets into a single, unified structure. This required several preparatory steps:

Standardizing Region Names
The Region variable in the DTP dataset used full WHO region names (e.g., "African Region"), while the other datasets used shorter or slightly different labels (e.g., "Africa"). To ensure consistency, I used mutate() and recode() to align the region names across datasets:

```{r}
DTPcoverage <- DTPcoverage %>%
mutate( Region = recode(Region, "African Region" = "Africa", "Eastern Mediterranean Region" = "Eastern Mediterranean", "European Region" = "Europe", "Region of the Americas" = "Americas", "South-East Asia Region" = "South-East Asia", "Western Pacific Region" = "Western Pacific" ) )
```

Renaming the Time Variable
The DTP dataset used PeriodGroup to represent grouped years (e.g., "2000–2004"), while the other datasets used Period. To match the column names for merging, I renamed PeriodGroup to Period:

```{r}
DTPcoverage <- DTPcoverage %>% rename(Period = PeriodGroup)
```

Merging the Datasets
I used inner_join() to merge the three datasets by Region and Period. This ensures that only rows with matching region-period combinations across all datasets are included:

```{r} 
merged_health_data <- avg_healthspending_by_period %>% inner_join(DTPcoverage, by = c("Region", "Period")) %>% inner_join(avg_childdeath_by_period, by = c("Region", "Period"))
```

Creating New Variables
To enrich the analysis, I constructed new variables that express relationships between the indicators:

```{r} 
merged_health_data <- merged_health_data %>%
  mutate( CoveragePerDollar = AvgCoverage / AvgSpending, DollarPerCoveragePoint = AvgSpending / AvgCoverage, DeathsPerSpending = AvgChildDeath / AvgSpending )
```

Final Formatting
The merged tibble was converted to a standard data frame for compatibility with certain functions:

```{r} 
merged_healthdata_df <- as.data.frame(merged_health_data)
```

This merged dataset forms the foundation for the correlation analysis and visualizations that follow.

---

# Visualization

## Spatial Visualization

```{r echo=FALSE, out.width="80%"}
knitr::include_graphics("Map.png")
```

### Interpretation and Relevance
This choropleth map visualizes the average DTP3 vaccination coverage across WHO regions for the period 2020–2022. It aligns directly with the research question—“How does government healthcare spending per capita correlate with national vaccination coverage rates for routine immunisations in low-, middle-, and high-income countries?”—by providing a geographic perspective on one of the key outcome variables: vaccination coverage.

By mapping regional averages, the visualization highlights geographical disparities in immunization performance. For example, regions such as Europe and the Western Pacific show high coverage rates, while others like Africa and the Eastern Mediterranean lag behind. These patterns help contextualize the statistical analysis by showing where coverage gaps are most pronounced and where policy interventions may be most needed.

This map also complements the merged dataset by visually reinforcing the regional dimension of the correlation analysis between healthcare spending, vaccination coverage, and child mortality.

## Temporal Visualization


```{r echo=FALSE, out.width="80%"}
knitr::include_graphics("CD and spending.png")
```


```{r echo=FALSE, out.width="80%"}
knitr::include_graphics("USD and coverage.png")
```


### Temporal Trends in Health Investment and Outcomes

These two line graphs visualize how healthcare efficiency and outcomes have evolved across WHO regions over five-year periods from 2000 to 2022. They align closely with the research question by showing how healthcare spending relates to vaccination coverage and child mortality over time.

#### Graph 1: Child Deaths per Spending over Time

- **What it shows**: The number of child deaths per unit of healthcare spending.
- **Trend**: A clear downward trend across all regions, indicating improved outcomes per dollar spent.
- **Notable pattern**: Africa and Europe show the most significant declines, suggesting major gains in healthcare efficiency or effectiveness.
- **Interpretation**: This trend reflects global progress in reducing child mortality, likely due to better-targeted spending, improved healthcare delivery, and expanded immunization coverage.

#### Graph 2: Dollar per Coverage Point over Time

- **What it shows**: The average cost (in USD) required to increase DTP3 vaccination coverage by one percentage point.
- **Trend**: Most regions show a relatively stable or slightly increasing cost over time.
- **Notable pattern**: The Western Pacific region shows a significant increase in cost per coverage point in recent years, suggesting rising marginal costs or reduced efficiency.
- **Interpretation**: While some regions maintain cost-effectiveness, others may be facing diminishing returns on investment in immunization programs.

#### Comparison and Dynamics

- **Efficiency vs. Outcome**: While the cost of achieving additional vaccination coverage is rising or stabilizing, the impact of spending on reducing child deaths is improving.
- **Temporal Insight**: These trends highlight the evolving dynamics of global health investment—where spending may be increasing, but so is its effectiveness in saving lives.

#### Implications

- Policymakers should consider both cost and outcome metrics when evaluating healthcare strategies.
- The rising cost per coverage point in some regions may call for more efficient delivery models or targeted interventions.
- The declining child deaths per spending metric is a positive signal of global health progress and a justification for continued investment.


## Sub-Population Visualization


```{r echo=FALSE, out.width="80%"}
knitr::include_graphics("subpopulation.png")
```

### Subgroup Analysis: Top vs Bottom 3 WHO Regions (2022)

This bar chart compares the top 3 and bottom 3 WHO regions based on average healthcare spending per capita in 2022. It visualizes three key metrics:

- **Average Health Spending (USD per capita)**
- **Average DTP3 Vaccination Coverage (%)**
- **Average Child Deaths**

#### Alignment with Research Topic

This visualization directly supports the research question:  
*"How does government healthcare spending per capita correlate with national vaccination coverage rates for routine immunisations?"*

By dividing regions into high- and low-spending groups, the plot highlights how investment levels relate to health outcomes across sub-populations.

#### Group Differences (Quantified)

| Metric       | Top 3 Regions | Bottom 3 Regions | Difference       |
|--------------|----------------|------------------|------------------|
| Spending     | \$1852.7       | \$305.9           | +\$1546.8        |
| Coverage     | 91%            | 82%               | +9%              |
| Child Deaths | 149,154.7      | 1,516,736.3       | −1,367,581.6     |

- Top 3 regions spend over **6 times more** per capita on healthcare.
- They achieve **9 percentage points higher** vaccination coverage.
- They experience nearly **10 times fewer** child deaths.

#### Evaluation of Subgroup Analysis

This subgroup comparison reveals a clear gradient: higher spending is associated with better vaccination outcomes and significantly lower child mortality. The differences are not only statistically meaningful but also socially and ethically significant, especially in the context of global health equity.

#### Implications

- **Policy Insight**: The data suggests that increasing healthcare investment in underfunded regions could substantially improve immunization coverage and reduce child mortality.
- **Equity Concern**: The stark contrast in child death rates underscores the urgent need for targeted support in low-spending regions.
- **Further Research**: This analysis invites deeper exploration into how efficiently funds are used and what other systemic factors (e.g., governance, infrastructure) influence outcomes.



## Event Analysis


### Interpetation and Relevance

---

# Discussion

---

# Reproducibility

## Github repository link

## Refrence list

- WHO Media Team. (2025, April 24). Increases in vaccine-preventable disease outbreaks threaten years of progress, warn WHO, UNICEF, Gavi . Retrieved from World Health Organization:             https://www.who.int/news/item/24-04-2025-increases-in-vaccine-preventable-disease-outbreaks-threaten-years-of-progress--warn-who--unicef--gavi
- UNICEF. (n.d.). Vaccines and the diseases they prevent. Retrieved from UNICEF: https://www.unicef.org/parenting/health/vaccines-and-diseases-they-prevent
- Xinhu Wang; Mamadou Diallo. (2019, September 24). UNICEF. Retrieved from How tracking DTP vaccine dropout rates helps protect children from preventable diseases: https://data.unicef.org/data-for-action/tracking-dtp-vaccine-dropout-rates-protects-children-from-preventable-diseases/
- unicef. (2024, July). Immunization. Retrieved from unicef: https://data.unicef.org/topic/child-health/immunization/
- Our World in Data. (n.d.). Deaths caused by vaccine-preventable diseases, World. Retrieved from Our World in Data: https://ourworldindata.org/grapher/deaths-caused-by-vaccine-preventable-diseases-over-time
- UNICEF. (2024, March). Vaccination & Immunization Statistics - UNICEF Data. Retrieved from UNICEF: https://knowledge.unicef.org/resource/vaccination-immunization-statistics-unicef-data


